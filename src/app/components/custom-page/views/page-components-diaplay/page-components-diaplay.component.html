@for (component of components(); track $index) {
  <div
    #componentEl
    class="page-component"
    [class]="component.type"
    [attr.data-id]="component.id"
    [style]="getComponentStyle(component)"
    (click)="clickComponent(component)"
    (dblclick)="dblClickComponent(component, componentEl)"
    cdkDrag
    [cdkDragDisabled]="getComponentDragDisabled(component)"
    (cdkDragStarted)="moveComponentStart(component)"
    (cdkDragMoved)="moveComponent($event, component)"
    (cdkDragEnded)="moveComponentEnd($event, component)"
  >
    @if (activeComponent()?.id === component.id) {
      @if (control(); as control) {
        <div class="page-component-control" [class]="control.class" [style]="control.style">
          @for (point of controlPoints; track $index) {
            <div
              class="point"
              [class]="point.position"
              cdkDrag
              cdkDragBoundary=".work-space"
              [cdkDragLockAxis]="point.axis"
              (cdkDragStarted)="moveResizePointStart()"
              (cdkDragMoved)="moveResizePoint($event, point)"
              (cdkDragEnded)="moveResizePointEnd($event)"
            >
              <div class="point-inner"></div>
            </div>
          }
          <div
            class="rotate-point"
            cdkDrag
            (cdkDragStarted)="moveRotatePointStart()"
            (cdkDragMoved)="moveRotatePoint($event, componentEl)"
            (cdkDragEnded)="moveRotatePointEnd($event)"
          >
            <mat-icon>rotate_right</mat-icon>
          </div>
        </div>
      }
    }
    <div class="page-component-content">
      @switch (component.type) {
        @case ("text") {
          <textarea
            matInput
            [value]="component.text"
            [readonly]="isEditingComponent()?.id !== component.id"
            (input)="onComponentTextInput($event, component)"
            cdkTextareaAutosize
            cdkAutosizeMinRows="1"
          ></textarea>
        }
      }
    </div>
  </div>
}
