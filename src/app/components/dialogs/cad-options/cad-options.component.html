<div class="toolbar">
  <app-input class="flex-110" [info]="searchInputInfo()"></app-input>
  @if (data.multi) {
    <button mat-flat-button (click)="selectAll()">全选当前数据</button>
  }
  @if (data.name && !data.useLocalOptions) {
    <button mat-flat-button (click)="search(true, true)">刷新</button>
  }
  @if (data.openInNewTab) {
    <button mat-flat-button (click)="editInNewTab()">
      <mat-icon>open_in_new</mat-icon>
      <span>编辑可选项</span>
    </button>
  }
</div>
@if (data.typeFiltering) {
  <div class="toolbar">
    <button mat-flat-button [color]="activeOptionTypes().length < 1 ? 'accent' : 'primary'" (click)="toggleActiveOptionType(null)">
      全部
    </button>
    @for (type of optionTypesManager.data(); track $index) {
      <button mat-flat-button [color]="activeOptionTypes().includes(type) ? 'accent' : 'primary'" (click)="toggleActiveOptionType(type)">
        {{ type }}
      </button>
    }
  </div>
}

<ng-scrollbar>
  <app-spinner [id]="loaderIds.optionsLoader"></app-spinner>
  <div class="options items add-empty-msg">
    @for (item of pageData(); track i; let i = $index) {
      <div class="option border item" [class.checked]="item.checked" (click)="onCheckboxChange(i)">
        <div class="toolbar">
          @if (data.defaultValue) {
            <button
              mat-button
              [color]="data.defaultValue.value === item.name ? 'accent' : 'primary'"
              appClickStop
              (click)="setDefaultValue(i)"
            >
              默认值
            </button>
          }
        </div>
        @if (!noImage()) {
          <app-image [src]="item.img" [prefix]="filePathUrl"></app-image>
        }
        <div class="option-name toolbar">
          <div class="toolbar">
            <mat-checkbox [checked]="item.checked" [disabled]="item.disabled && !item.checked"> </mat-checkbox>
            <div class="flex-110">{{ item.label || item.name }}</div>
          </div>
        </div>
      </div>
    }
  </div>
</ng-scrollbar>

@if (showPaginator()) {
  <mat-paginator
    #paginator
    [length]="length()"
    [pageSize]="pageSize()"
    [pageSizeOptions]="pageSizeOptions()"
    showFirstLastButtons
    (page)="changePage($event)"
  ></mat-paginator>
}

<div matDialogActions>
  <div class="spinner-container">
    <button mat-flat-button (click)="submit()">确定</button>
    <app-spinner [id]="loaderIds.submitLoaderId" [inline]="true"></app-spinner>
  </div>
  <button mat-flat-button (click)="close()">取消</button>
</div>
